:root {
  --bg: #ffffff;
  --panel: #f8fafc;
  --text: #0f172a;
  --muted: #64748b;
  --accent: #3ddc84;
  --border: #e2e8f0;
  --code-bg: #f5f7fa;
}
.theme-dark {
  --bg: #0f172a;
  --panel: #111827;
  --text: #e5e7eb;
  --muted: #9ca3af;
  --accent: #3ddc84;
  --border: #1f2937;
  --code-bg: #0b1220;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font: 16px/1.75 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
  color: var(--text);
  background: var(--bg);
}

.site-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: var(--panel);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  z-index: 10;
}
.brand { display: flex; align-items: center; gap: 10px; }
.logo { width: 35px; height: 35px; display: inline-block; color: var(--accent); object-fit: contain; object-position: center; }
.brand h1 { margin: 0; font-size: 18px; font-weight: 700; letter-spacing: .02em; }

.search-box { display: flex; align-items: center; gap: 10px; }
.search-box input {
  width: 360px;
  max-width: 46vw;
  padding: 10px 12px;
  border-radius: 8px;
  border: 1px solid var(--border);
  outline: none;
  background: var(--panel);
  color: var(--text);
}
.search-box input::placeholder { color: var(--muted); }

.site-main { display: grid; grid-template-columns: minmax(240px, 18vw) 1fr minmax(240px, 16vw); min-height: calc(100vh - 96px); gap: 0; justify-content: center; }
.sidebar {
  padding: 16px;
  border-right: 1px solid var(--border);
  background: var(--panel);
}
.sidebar h2 { margin: 18px 0 10px; font-size: 13px; color: var(--muted); text-transform: capitalize; letter-spacing: .02em; cursor: pointer; position: relative; padding-left: 18px; }
.sidebar h2::before { content: "▾"; position: absolute; left: 0; top: 50%; transform: translateY(-50%) rotate(-90deg); color: var(--muted); transition: transform .2s ease; }
.sidebar h2.expanded::before { transform: translateY(-50%) rotate(0deg); }
.sidebar h2.single::before { content: none; }
.sidebar .sidebar-group { margin-left: 2px; overflow: hidden; transition: max-height .24s ease, opacity .2s ease; }
.sidebar .sidebar-group.collapsed { max-height: 0; opacity: 0; }
.sidebar .sidebar-group.expanded { opacity: 1; }
.sidebar a { display: block; color: var(--text); text-decoration: none; padding: 8px 10px; border-radius: 6px; }
.sidebar a:hover { background: rgba(14, 165, 233, 0.08); }
.sidebar .active { background: rgba(14, 165, 233, 0.12); border: 1px solid var(--border); }
.sidebar .page-row { display: flex; align-items: center; gap: 6px; padding: 6px 8px; border-radius: 6px; cursor: pointer; }
.sidebar .page-row:hover { background: rgba(61, 220, 132, 0.08); }
.sidebar .page-fold { width: 14px; text-align: center; color: var(--muted); transition: transform .2s ease; }
.sidebar .page-fold.collapsed { transform: rotate(-90deg); }
.sidebar .children { margin-left: 14px; border-left: 2px solid var(--border); padding-left: 8px; overflow: hidden; transition: max-height .24s ease, opacity .2s ease; }
.sidebar .children.collapsed { max-height: 0; opacity: 0; }
.sidebar .children.expanded { opacity: 1; }

.content { padding: 24px 32px; display: block; margin-left: auto; margin-right: auto; }
.content { max-width: clamp(820px, 75vw, 1400px); }
.doc-toolbar { display: flex; gap: 8px; margin-bottom: 12px; }
.nav-btn { padding: 8px 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--panel); color: var(--text); cursor: pointer; }
.nav-btn:hover { border-color: var(--accent); color: var(--accent); }
.nav-btn.icon-btn { width: 36px; height: 36px; padding: 0; display: inline-flex; align-items: center; justify-content: center; }
.nav-icon { width: 18px; height: 18px; display: inline-block; }
.doc-title { font-size: 24px; font-weight: 700; margin-bottom: 14px; }
.doc-body { line-height: 1.8; }
.doc-body code { background: var(--code-bg); padding: 2px 6px; border-radius: 6px; border: 1px solid var(--border); }
.doc-body pre { background: var(--code-bg); padding: 14px; overflow: auto; border-radius: 10px; border: 1px solid var(--border); }
.doc-body h2, .doc-body h3 { margin-top: 24px; }

.doc-body img { max-width: 100%; height: auto; border-radius: 10px; border: 1px solid var(--border); display: block; margin: 10px 0; }
.doc-body figure { margin: 12px 0; }
.doc-body figcaption { color: var(--muted); font-size: 13px; margin-top: 6px; }

.section { border: 1px solid var(--border); border-radius: 10px; margin: 14px 0; background: var(--panel); }
.section-title { margin: 0; padding: 12px 14px; cursor: pointer; display: flex; align-items: center; gap: 8px; }
.section-title::before { content: "▾"; display: inline-block; transform: rotate(0deg); transition: transform .2s ease; color: var(--muted); }
.section.collapsed .section-title::before { transform: rotate(-90deg); }
.section-content { padding: 6px 14px 14px; }
.section.collapsed .section-content { display: none; }

.search-results { margin-top: 8px; }
.result-item { padding: 10px 12px; border: 1px solid var(--border); border-radius: 10px; margin-bottom: 10px; background: var(--panel); }
.result-item .title { font-weight: 600; }
.result-item .snippet { color: var(--muted); font-size: 14px; }

.site-footer { padding: 16px; border-top: 1px solid var(--border); text-align: center; color: var(--muted); background: var(--panel); }

@media (max-width: 980px) {
  .site-header { gap: 15px; }
  .site-main { grid-template-columns: 1fr; }
  .brand h1 { display: none; }
  .search-box { flex: 1; gap: 12px; align-items: center; }
  .search-box input { flex: 0 1 66vw; width: auto; max-width: 66vw; height: 36px; padding: 0 12px; box-sizing: border-box; }
  .content { padding: 16px; max-width: 100%; }
  .doc-body { padding-bottom: 24px; }
  .doc-body h1, .doc-body h2 { margin-top: 18px; }
  .toc { display: none; }
  .sidebar { position: fixed; left: 0; top: 60px; width: 82vw; max-width: 320px; height: calc(100vh - 60px); box-shadow: 2px 0 12px rgba(0,0,0,.12); transform: translateX(-100%); transition: transform .24s ease; z-index: 32; overflow: auto; pointer-events: none; }
  .show-sidebar .sidebar { transform: translateX(0); }
  .show-sidebar .sidebar { pointer-events: auto; }
  .doc-body pre { white-space: pre-wrap; word-break: break-word; }
  .breadcrumb { flex-wrap: wrap; }
  .bottom-nav { grid-template-columns: 1fr; width: 100%; }
  /* Mobile-only show menu button */
  #menu-toggle { display: inline-flex; }
  /* Align logo to the same square size as buttons */
  .brand .logo { width: 36px; height: 36px; padding: 6px; border: 1px solid var(--border); border-radius: 8px; background: var(--panel); display: inline-flex; align-items: center; justify-content: center; box-sizing: border-box; }
  /* Ensure theme toggle emoji centered and sized */
  #theme-toggle.icon-btn { font-size: 18px; line-height: 1; }
  /* Mobile tables and code */
  .doc-body table { display: block; width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
  .doc-body pre code { white-space: pre-wrap; word-break: break-word; }
  .doc-body ul, .doc-body ol { padding-left: 20px; }
}

@media (max-width: 420px) {
  .site-header { gap: 10px; padding: 10px 12px; }
  .search-box { gap: 8px; }
  .search-box input { flex-basis: 100%; max-width: 100%; }
}

.mobile-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.35); display: none; z-index: 20; }
.show-sidebar .mobile-overlay { display: block; }

@media (min-width: 981px) { #menu-toggle { display: none; } }
.toc { border-left: 1px solid var(--border); padding: 16px; background: var(--panel); position: sticky; top: 60px; height: calc(100vh - 60px); overflow: auto; }
.toc h2 { margin: 6px 0 10px; font-size: 13px; color: var(--muted); text-transform: capitalize; letter-spacing: .02em; }
.toc .toc-list { list-style: none; padding: 0; margin: 0; }
.toc ul { list-style: none; padding-left: 0; margin: 0; }
.toc .toc-item { margin: 4px 0; border-left: 2px solid transparent; border-radius: 10px; }
.toc .toc-row { display: flex; align-items: center; gap: 6px; padding: 8px 10px; border-radius: 10px; color: var(--text); text-decoration: none; cursor: pointer; transition: background .18s ease, color .18s ease; width: 100%; box-sizing: border-box; }
.toc .toc-row:hover { background: rgba(61, 220, 132, 0.08); }
.toc .label { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.toc .toc-item.active { border-left-color: var(--accent); }
.toc .toc-item.active > .toc-row { color: var(--accent); background: rgba(61, 220, 132, 0.12); font-weight: 600; }
.toc .lvl-2 { padding-left: 0px; }
.toc .lvl-3 { padding-left: 10px; }
.toc .lvl-4 { padding-left: 18px; }
.toc .lvl-5 { padding-left: 26px; }
.toc .fold { width: 16px; text-align: center; color: var(--muted); transform: rotate(0deg); transition: transform .2s ease; flex: 0 0 16px; }
.toc .toc-item.collapsed > .toc-row .fold { transform: rotate(-90deg); }
.toc .collapsible { overflow: hidden; transition: max-height .24s ease, opacity .2s ease; }
.toc .collapsible.collapsed { max-height: 0; opacity: 0; }
.toc .collapsible.expanded { opacity: 1; }
.lightbox { position: fixed; inset: 0; background: rgba(0,0,0,0.75); display: none; align-items: center; justify-content: center; z-index: 100; }
.lightbox img { max-width: min(92vw, 1200px); max-height: 88vh; border-radius: 12px; background: #000; }
.lightbox.show { display: flex; }
.breadcrumb { display: flex; align-items: center; gap: 8px; color: var(--muted); font-size: 14px; margin-bottom: 8px; }
.breadcrumb a { color: var(--text); text-decoration: none; padding: 4px 8px; border-radius: 8px; display: inline-flex; align-items: center; gap: 6px; flex: 0 0 auto; }
.breadcrumb a:hover { background: rgba(61, 220, 132, 0.10); }
.breadcrumb .sep { color: var(--muted); }
.breadcrumb .current { color: var(--accent); font-weight: 600; background: rgba(61, 220, 132, 0.12); padding: 4px 8px; border-radius: 8px; }
.breadcrumb .home-icon { width: 18px; height: 18px; display: inline-block; }

.bottom-nav { display: flex; gap: 16px; margin-top: 22px; justify-content: space-between; align-items: stretch; }
.bottom-card { display: block; border: 1px solid var(--border); border-radius: 12px; padding: 14px; text-decoration: none; background: var(--panel); transition: border-color .18s ease, transform .18s ease; }
.bottom-card:hover { border-color: var(--accent); transform: translateY(-1px); }
.bottom-card .meta { color: var(--muted); font-size: 13px; }
.bottom-card .title { color: var(--accent); font-weight: 600; margin-top: 4px; }
.bottom-card.left { text-align: left; }
.bottom-card.right { text-align: right; }

/* Overrides for requested UI tweaks */
.breadcrumb a.current { color: var(--accent); font-weight: 600; background: rgba(61, 220, 132, 0.12); padding: 4px 8px; border-radius: 8px; }
.bottom-nav { display: grid; grid-template-columns: 1.2fr 1.2fr; gap: 20px; margin-top: 26px; }
.bottom-card { padding: 18px; }
.bottom-card .title { margin-top: 6px; font-size: 16px; }
.toc { font-size: 13px; }
.toc .toc-row { padding: 6px 8px; }
.toc .fold { width: 14px; }

/* Typography adjustments */
.doc-title { font-size: 24px; }
.doc-body h2 { font-size: 22px; }
.doc-body h3 { font-size: 18px; }
.doc-body h4 { font-size: 16px; }
.sidebar a { font-size: 14px; }
.sidebar .page-row { font-size: 14px; }
.doc-title.has-children { cursor: pointer; }
.cards { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 12px; margin: 10px 0 18px; }
.card { border: 1px solid var(--border); border-radius: 12px; background: var(--panel); padding: 12px; cursor: pointer; transition: border-color .18s ease, transform .18s ease; }
.card:hover { border-color: var(--accent); transform: translateY(-1px); }
.card .card-title { font-weight: 600; margin-bottom: 6px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.card .card-desc { color: var(--muted); font-size: 14px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
